<mxfile host="app.diagrams.net" modified="2026-02-02T00:00:00.000Z" agent="GitHub Copilot" version="22.1.1" type="device">
  <diagram name="NADIA-SupplierPortal-Flow" id="NADIA-Flow">
    <mxGraphModel dx="1800" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="NADIA → Supplier Portal (Flux de données)" style="text;html=1;fontSize=18;fontStyle=1;align=center;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="420" y="20" width="960" height="40" as="geometry" />
        </mxCell>

        <!-- Lanes -->
        <mxCell id="laneNadia" value="FAP-65 (NADIA)" style="swimlane;html=1;rounded=1;startSize=28;fillColor=#E3F2FD;strokeColor=#1E88E5;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="820" height="380" as="geometry" />
        </mxCell>
        <mxCell id="laneSupplier" value="FAP-57 (Supplier Portal)" style="swimlane;html=1;rounded=1;startSize=28;fillColor=#E8F5E9;strokeColor=#43A047;" vertex="1" parent="1">
          <mxGeometry x="940" y="80" width="820" height="380" as="geometry" />
        </mxCell>

        <!-- Shared resources -->
        <mxCell id="shared" value="Ressources partagées" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#616161;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="500" width="1720" height="180" as="geometry" />
        </mxCell>

        <!-- NADIA flow nodes -->
        <mxCell id="timer" value="Timer Trigger\n(04:00 CET)" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10833-icon-service-Scheduler.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="laneNadia">
          <mxGeometry x="30" y="70" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="fap65" value="Azure Functions\nRetrivePOVendor" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10029-icon-service-Function-Apps.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=70;" vertex="1" parent="laneNadia">
          <mxGeometry x="180" y="60" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="sql" value="Azure SQL\n(stored proc)" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10130-icon-service-SQL-Database.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="laneNadia">
          <mxGeometry x="30" y="210" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="sbTopic" value="Service Bus Topic\n(purchase-orders)" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10836-icon-service-Azure-Service-Bus.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=70;" vertex="1" parent="laneNadia">
          <mxGeometry x="180" y="200" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="table" value="Table Storage\n(LastExecution)" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10841-icon-service-Table.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="laneNadia">
          <mxGeometry x="360" y="210" width="90" height="90" as="geometry" />
        </mxCell>

        <!-- Supplier Portal flow nodes -->
        <mxCell id="sbSub" value="Service Bus\nSubscription (spa-processor)" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10836-icon-service-Azure-Service-Bus.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=70;" vertex="1" parent="laneSupplier">
          <mxGeometry x="30" y="60" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="fap57" value="Azure Functions\nSendPOSupplier" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10029-icon-service-Function-Apps.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=70;" vertex="1" parent="laneSupplier">
          <mxGeometry x="210" y="60" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="lucy" value="Lucy API\n(HTTP GET /api/users)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#9E9E9E;" vertex="1" parent="laneSupplier">
          <mxGeometry x="30" y="210" width="160" height="70" as="geometry" />
        </mxCell>
        <mxCell id="dataverse" value="Dataverse\n(Upsert)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#9E9E9E;" vertex="1" parent="laneSupplier">
          <mxGeometry x="210" y="210" width="160" height="70" as="geometry" />
        </mxCell>

        <!-- Shared resources nodes -->
        <mxCell id="keyvault" value="Key Vault" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10245-icon-service-Key-Vaults.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="shared">
          <mxGeometry x="70" y="60" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="appinsights" value="Application Insights" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/00012-icon-service-Application-Insights.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="shared">
          <mxGeometry x="260" y="60" width="100" height="90" as="geometry" />
        </mxCell>
        <mxCell id="sbNamespace" value="Service Bus Namespace" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10836-icon-service-Azure-Service-Bus.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=70;" vertex="1" parent="shared">
          <mxGeometry x="460" y="50" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="storageAccount" value="Storage Account" style="shape=image;image=https://raw.githubusercontent.com/bitesinbyte/azure-draw-io-assets/main/img/10086-icon-service-Storage-Accounts.svg;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;align=center;imageAlign=center;imageVerticalAlign=middle;spacingTop=60;" vertex="1" parent="shared">
          <mxGeometry x="660" y="60" width="100" height="90" as="geometry" />
        </mxCell>

        <!-- Edges NADIA -->
        <mxCell id="e1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1E88E5;" edge="1" parent="laneNadia" source="timer" target="fap65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" value="Lecture PO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1E88E5;" edge="1" parent="laneNadia" source="fap65" target="sql">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" value="Publish message" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1E88E5;" edge="1" parent="laneNadia" source="fap65" target="sbTopic">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4" value="Update execution" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1E88E5;" edge="1" parent="laneNadia" source="fap65" target="table">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Edges Supplier Portal -->
        <mxCell id="e5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#43A047;" edge="1" parent="laneSupplier" source="sbSub" target="fap57">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" value="Enrich user" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#43A047;" edge="1" parent="laneSupplier" source="fap57" target="lucy">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e7" value="Upsert" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#43A047;" edge="1" parent="laneSupplier" source="fap57" target="dataverse">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Cross flow Service Bus -->
        <mxCell id="e8" value="PurchaseOrderMessage" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="sbTopic" target="sbSub">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Shared resource links (dashed) -->
        <mxCell id="e9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="keyvault" target="fap65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="keyvault" target="fap57">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="appinsights" target="fap65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="appinsights" target="fap57">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="sbNamespace" target="sbTopic">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="sbNamespace" target="sbSub">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#616161;" edge="1" parent="1" source="storageAccount" target="table">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
